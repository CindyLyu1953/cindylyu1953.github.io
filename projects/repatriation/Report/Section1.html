<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.54">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>section1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html"> 
<span class="menu-text">Main Site</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../project.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../background_intro.html"> 
<span class="menu-text">Background</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-report" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Report</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-report">    
        <li>
    <a class="dropdown-item" href="../Report/Section1.html">
 <span class="dropdown-text">Temporal</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Report/Section2.html">
 <span class="dropdown-text">Geospatial</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Report/Section3.html">
 <span class="dropdown-text">Institutional</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Report/Conclusion.html">
 <span class="dropdown-text">Conclusion</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-technical-details" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Technical details</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-technical-details">    
        <li>
    <a class="dropdown-item" href="../code/data_cleaning.html">
 <span class="dropdown-text">Data Cleaning</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../code/q3.html">
 <span class="dropdown-text">Temporal</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../code/q2.html">
 <span class="dropdown-text">Geospatial - States</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../code/q4.html">
 <span class="dropdown-text">Geospatial - Land Origins</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../code/q1.html">
 <span class="dropdown-text">Institutional - Different Types of Institutions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../code/q5.html">
 <span class="dropdown-text">Institutional - Universities</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content column-page" id="quarto-document-content">




<section id="uncovering-the-patterns-of-repatriation-a-multi-lens-exploration" class="level1">
<h1>Uncovering the Patterns of Repatriation: A Multi-Lens Exploration</h1>
<section id="temporal" class="level2">
<h2 class="anchored" data-anchor-id="temporal">Temporal</h2>
<hr>
<div style="text-align:center; font-size:1.5rem; color:#000000; margin-top:2rem;">
<p>The passage of NAGPRA in 1990 marked a legal commitment to the repatriation of Native American remains and cultural heritage. However, the pace and pattern of repatriation have varied significantly over time. In this section, we examine how repatriation efforts have unfolded year by year, focusing not only on total numbers but also on the different categories of items being returned—such as individuals, funerary objects, sacred items, and cultural patrimony. Through these trends, we reveal how policy changes, institutional actions, and historical reckonings have shaped the tempo of justice.</p>
</div>
<hr>
<!-- temporal -->
<!-- trends of repatriated items -->
<iframe src="../img/q3_Repatriated_time_trends.html" width="100%" height="600px" frameborder="0"></iframe>
<p><span style="font-size:0.8em; color:#100606;">Figure 1.1 - Repatriation by Year</span></p>
<p><span style="font-size:0.8em; color:#100606;">This visualization is an interactive line chart that allows users to explore the repatriation trends by different object categories. By selecting from the dropdown menu on the right—such as Individuals, Funerary Objects, Sacred Objects, or Cultural Patrimony—you can dynamically update the chart to focus on specific types of repatriated items. This functionality enables a deeper, comparative exploration of how different categories have contributed to the overall patterns of repatriation across time.</span></p>
</section>
<section id="repatriation-by-year" class="level2">
<h2 class="anchored" data-anchor-id="repatriation-by-year">Repatriation by Year</h2>
<section id="total-repatriated-items-by-year" class="level3">
<h3 class="anchored" data-anchor-id="total-repatriated-items-by-year">① Total Repatriated Items by Year</h3>
<p>This interactive line chart visualizes the total number of repatriated items each year since NAGPRA’s enactment. A key pattern is the dramatic peak in 2024, with over 1.73 million items repatriated—significantly higher than any previous year. This spike corresponds to the implementation of <strong>updated NAGPRA regulations under the Biden administration</strong>, alongside intensified institutional efforts, reflecting <strong>growing federal pressure</strong> and moral accountability.</p>
</section>
<section id="individuals-repatriated-each-year" class="level3">
<h3 class="anchored" data-anchor-id="individuals-repatriated-each-year">② Individuals Repatriated Each Year</h3>
<p>This chart shows the number of Native American ancestral remains repatriated annually. Two major peaks stand out—one around 1998, and a larger one in 2023. The first surge follows a <strong>collaborative effort between the U.S. Navy and the Bishop Museum</strong> to return over 3,000 ancestral remains from Mokapu Peninsula, Oʻahu. The second peak reflects the <strong>Tennessee Valley Authority</strong>’s return of over 4,800 remains in 2023, which is one of the largest NAGPRA actions in the region. These spikes signal how <strong>institutional collaboration and legal pressure</strong> can translate into large-scale restitutions of ancestral dignity.</p>
</section>
<section id="funerary-objects-repatriated-each-year" class="level3">
<h3 class="anchored" data-anchor-id="funerary-objects-repatriated-each-year">③ Funerary Objects Repatriated Each Year</h3>
<p>This chart reveals a dramatic increase in the number of funerary objects returned in 2024, largely driven by Sacramento State’s repatriation of over 1.28 million items following a campus-wide investigation. The magnitude of this return underscores both the <strong>scale of past accumulation</strong> and the power of institutional accountability in response to scrutiny and new federal guidance.</p>
</section>
<section id="unassociated-funerary-objects-by-year" class="level3">
<h3 class="anchored" data-anchor-id="unassociated-funerary-objects-by-year">④ Unassociated Funerary Objects by Year</h3>
<p>This chart illustrates the annual count of unassociated funerary objects—those not clearly tied to specific individuals. A pronounced spike in 2017 marks the reporting of over 55,000 such items by the Army Corps of Engineers, from a 1961 excavation in South Dakota later linked to the Yankton Sioux Tribe. The return of these objects, despite uncertain provenance, reflects <strong>an ethical shift toward restitution even in the absence of complete documentation</strong>.</p>
</section>
<section id="sacred-objects-by-year" class="level3">
<h3 class="anchored" data-anchor-id="sacred-objects-by-year">⑤ Sacred Objects by Year</h3>
<p>This chart tracks the number of sacred items returned each year under NAGPRA. A notable spike occurs in 2005, when the National Park Service facilitated the repatriation of sacred objects from Chaco Culture National Historical Park to the Pueblo of Zia. Although the numbers remain relatively low, <strong>each instance holds immense spiritual significance, often requiring deep consultation and ceremonial respect, which makes every return a powerful act of cultural restoration</strong>.</p>
</section>
<section id="cultural-patrimony-objects-by-year" class="level3">
<h3 class="anchored" data-anchor-id="cultural-patrimony-objects-by-year">⑥ Cultural Patrimony Objects by Year</h3>
<p>This chart highlights the return of items classified as cultural patrimony—those of collective importance to tribal nations. A peak in 2024 corresponds with Sacramento State’s return of remains and funerary objects originally taken in 1978. <strong>These items, representing communal heritage rather than individual ownership, symbolize a deeper institutional recognition of Indigenous cultural sovereignty</strong> and the need to reconcile with long-ignored histories.</p>
</section>
<section id="objects-tagged-as-both-ocp-so" class="level3">
<h3 class="anchored" data-anchor-id="objects-tagged-as-both-ocp-so">⑦ Objects Tagged as Both OCP &amp; SO</h3>
<p>This chart shows the number of items repatriated each year that were identified as both sacred objects and cultural patrimony—dual-classification categories under NAGPRA. A distinct peak appears in 2024, when the Oakland Museum of California announced the return of 332 such items. This case stands out not only for its volume, but also for its complexity: <strong>dual-tagged objects</strong> often embody both ceremonial and communal significance, making their classification and rightful return especially meaningful. This moment represents one of the <strong>largest and most symbolically layered repatriation efforts under NAGPRA</strong> to date.</p>
<hr>
<iframe src="../img/q3_linked_view_for_year_details.html" width="100%" height="1200px" frameborder="0"></iframe>
<p><span style="font-size:0.8em; color:#100606;">Figure 1.2 - Repatriation by Year with Breakdown</span></p>
<p><span style="font-size:0.8em; color:#100606;">This interactive visualization consists of two linked components: the upper line chart displays the total number of repatriated items by year, while the lower bar chart provides a detailed breakdown of repatriated item types (e.g., Individuals, Funerary Objects, Unassociated Funerary Objects, Sacred Objects, Cultural Patrimony, and Dual-Classified Items) for a selected year. Clicking on a specific year in the line chart dynamically updates the bar chart below, allowing viewers to explore how the composition of repatriated items varies year by year.</span></p>
</section>
</section>
<section id="repatriation-by-year-with-breakdown" class="level2">
<h2 class="anchored" data-anchor-id="repatriation-by-year-with-breakdown">Repatriation by Year with Breakdown</h2>
<p>Across most years, <strong>funerary objects consistently represent the largest share of repatriated items</strong>, reflecting the historical prevalence of funerary artifacts in institutional holdings. Although there are fluctuations, funerary objects overwhelmingly dominate repatriation activity compared to other categories like sacred objects or cultural patrimony. This pattern highlights an ongoing need to <strong>address broader categories of Indigenous cultural heritage in repatriation efforts</strong>.</p>
<hr>
<div style="text-align:center; font-size:1.5rem; color:#000000; margin-top:2rem;">
<p>The temporal trends reveal a long period of stagnation, punctuated by a recent and dramatic increase in repatriation activity, particularly in 2023 and 2024. These shifts align with regulatory reform, public pressure, and growing ethical accountability. However, the data also expose decades of institutional inertia and missed opportunities. While the upward trend offers hope, it also calls for sustained and comprehensive commitment. Repatriation must not be a one-time surge, but a continuous, institutionalized practice of justice and healing, and one that fully addresses all categories of Indigenous cultural heritage.</p>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>